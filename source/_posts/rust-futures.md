---
title: Rust 异步编程（二）：Future 和 Wake 
date: 2023-02-20 09:56:48
published: false
tags:
categories:
- Rust
---

上一节我们大概知道了一些异步编程概念，我们快速简单的复习一下：

1、Rust 依靠生产者和消费者模型来实现异步编程；

2、被定义为asyn 的函数，其返回值为一个 future，调用它的 await 方法会触发函数的执行；

3、 因此，IO 线程完成工作后给主线成发送消息，触发 await，从而实现异步。

以上是上一节讲的最最简单的异步编程模型，但 Rust 异步编程并不是这么简单，因为上一节的模型中，我们没有模拟 IO 阻塞，因此，await 实际上是不会阻塞的，但 Rust 异步编程中，恰恰是因为 await 中有 IO 操作会产生阻塞而设计的。

那么，await 到底是怎么用的呢？更关键的是，如果 await 是阻塞的，那么是怎么做到一个线程的情况下切换上下文的呢？如何做 await 的 IO 操作完成后继续往下执行的呢？

本节将会把 await 展开，引入关键的两个 trait： Future 和 Wake，把 Rust 的异步编程模型说清楚。

<!--more-->
